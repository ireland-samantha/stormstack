# Quarkus application configuration
quarkus.application.name=lightningfirefly-api

# Index dependencies for CDI and config mapping discovery
quarkus.index-dependency.lightning-auth-adapter.group-id=ca.samanthaireland
quarkus.index-dependency.lightning-auth-adapter.artifact-id=lightning-auth-adapter-quarkus-provider

# Container image configuration
quarkus.container-image.group=samantha
quarkus.container-image.name=quarkus-web-api
quarkus.container-image.tag=0.0.2

# HTTP configuration
quarkus.http.port=8080

# CORS - allow web panel access
quarkus.http.cors=true
quarkus.http.cors.origins=*
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=Content-Type,Authorization

# Logging
quarkus.log.level=INFO
quarkus.log.category."ca.samanthaireland.lightning".level=DEBUG

# Jackson configuration
quarkus.jackson.fail-on-unknown-properties=false

# Simulation configuration
simulation.snapshot.broadcast-interval-ms=100

# ECS configuration
ecs.max-entities=1000000
ecs.max-components=100

# Game loop configuration
gameloop.max-commands-per-tick=10000

# Storage paths
storage.modules-path=modules
storage.resources-path=resources

# GUI JAR path for download endpoint
# In Docker: /app/gui/lightning-gui.jar (set via GUI_JAR_PATH env var)
# Local dev: uses relative path to built JAR (auto-detected in GuiDownloadResource)
gui.jar.path=${GUI_JAR_PATH:}

# Storage for AI
storage.ai-path=ai

# JWT Security Configuration
# Use RSA keys for JWT signing/verification (MicroProfile JWT standard)
mp.jwt.verify.publickey.location=classpath:publicKey.pem
mp.jwt.verify.issuer=https://lightningfirefly.com
smallrye.jwt.sign.key.location=classpath:privateKey.pem
# Map the 'roles' claim to groups (auth service uses 'roles', not 'groups')
smallrye.jwt.path.groups=roles

# Auth enabled by default, can be disabled for development/testing
auth.enabled=${AUTH_ENABLED:true}

# Lightning Auth adapter configuration
# Reads from AUTH_ENABLED env var, defaults to true
lightning.auth.enabled=${AUTH_ENABLED:true}
lightning.auth.service-url=${AUTH_SERVICE_URL:http://localhost:8082}
lightning.auth.jwt.secret=${JWT_SECRET:}

# MongoDB configuration (for snapshot persistence)
# Connection string can be overridden via MONGODB_URI environment variable
quarkus.mongodb.connection-string=${MONGODB_URI:mongodb://localhost:27017}

# Snapshot persistence configuration
# Disabled by default - enable via SNAPSHOT_PERSISTENCE_ENABLED=true
snapshot.persistence.enabled=${SNAPSHOT_PERSISTENCE_ENABLED:false}
snapshot.persistence.database=${SNAPSHOT_PERSISTENCE_DATABASE:lightningfirefly}
snapshot.persistence.collection=${SNAPSHOT_PERSISTENCE_COLLECTION:snapshots}
snapshot.persistence.tick-interval=${SNAPSHOT_PERSISTENCE_TICK_INTERVAL:1}

# External Auth Service configuration (lightning-auth)
# When auth-service.url is set, authentication operations are delegated to the external service
auth-service.url=${AUTH_SERVICE_URL:}
auth-service.connect-timeout-ms=${AUTH_SERVICE_CONNECT_TIMEOUT:5000}
auth-service.request-timeout-ms=${AUTH_SERVICE_REQUEST_TIMEOUT:10000}
# Set to true to validate WebSocket tokens via the auth service (default: local JWT validation)
auth-service.websocket-validation-enabled=${AUTH_SERVICE_WEBSOCKET_VALIDATION:false}

# Control Plane client configuration
# When control-plane.url is set, this node will register with the control plane
# Optional properties are NOT defined here - set via env vars: CONTROL_PLANE_URL, CONTROL_PLANE_TOKEN, ADVERTISE_ADDRESS, NODE_ID
control-plane.heartbeat-interval-seconds=${HEARTBEAT_INTERVAL_SECONDS:10}
control-plane.max-containers=${MAX_CONTAINERS:100}
